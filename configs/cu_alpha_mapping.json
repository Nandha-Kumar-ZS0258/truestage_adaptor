{
  "cu_id": "CU_ALPHA",
  "cu_name": "Alpha Community Credit Union",
  "source_type": "CSV",
  "adapter_version": "1.0",
  "target_table": "Members",
  "file_delimiter": ",",
  "has_header": true,
  "date_default_format": "MM/dd/yyyy",
  "mappings": [
    {
      "source_col": "MemberID",
      "target_col": "source_member_id",
      "transform": "trim",
      "required": true
    },
    {
      "source_col": "FName",
      "target_col": "first_name",
      "transform": "trim"
    },
    {
      "source_col": "LName",
      "target_col": "last_name",
      "transform": "trim"
    },
    {
      "source_col": "DOB",
      "target_col": "date_of_birth",
      "transform": "date:MM/dd/yyyy"
    },
    {
      "source_col": "Email",
      "target_col": "email",
      "transform": "trim"
    },
    {
      "source_col": "Phone",
      "target_col": "phone",
      "transform": "trim"
    },
    {
      "source_col": "Bal",
      "target_col": "account_balance",
      "transform": "trim, to_decimal"
    },
    {
      "source_col": "Status",
      "target_col": "member_status",
      "transform": "value_map:A->ACTIVE,I->INACTIVE,C->CLOSED"
    },
    {
      "source_col": "Branch",
      "target_col": "branch_code",
      "transform": "trim"
    },
    {
      "source_col": null,
      "target_col": "as_of_date",
      "transform": "default:utcnow"
    }
  ],
  "dq_rules": [
    { "column": "source_member_id", "rule": "not_null", "action": "log_and_skip" },
    { "column": "account_balance",  "rule": "positive",  "action": "log_and_skip" },
    { "column": "date_of_birth",    "rule": "valid_date", "action": "log_and_skip" }
  ]
}
